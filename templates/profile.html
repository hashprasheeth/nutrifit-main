{% extends "base.html" %}

{% block title %}Profile - Nutri AI Insight{% endblock %}

{% block content %}
<div class="profile-container fade-in">
    <h1 class="page-title slide-in fade-up">Your Profile</h1>
    
    <form class="profile-form slide-up" method="POST" action="{{ url_for('profile') }}">
        <div class="form-section slide-in fade-up" style="animation-delay: 0.1s;">
            <h2>Personal Information</h2>
            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" value="{{ user_profile.name if user_profile else '' }}">
            </div>
            <div class="form-group">
                <label for="age">Age</label>
                <input type="number" id="age" name="age" min="15" max="120" value="{{ user_profile.age if user_profile else '' }}">
            </div>
            <div class="form-group">
                <label for="gender">Gender</label>
                <select id="gender" name="gender">
                    <option value="">Select</option>
                    <option value="male" {{ 'selected' if user_profile and user_profile.gender == 'male' else '' }}>Male</option>
                    <option value="female" {{ 'selected' if user_profile and user_profile.gender == 'female' else '' }}>Female</option>
                    <option value="other" {{ 'selected' if user_profile and user_profile.gender == 'other' else '' }}>Other</option>
                </select>
            </div>
        </div>
        
        <div class="form-section slide-in fade-up" style="animation-delay: 0.2s;">
            <h2>Body Metrics</h2>
            <div class="form-group">
                <label for="height">Height (cm)</label>
                <input type="number" id="height" name="height" min="100" max="250" step="0.1" value="{{ user_profile.height if user_profile else '' }}">
            </div>
            <div class="form-group">
                <label for="weight">Weight (kg)</label>
                <input type="number" id="weight" name="weight" min="30" max="300" step="0.1" value="{{ user_profile.weight if user_profile else '' }}">
            </div>
            <div id="bmi-result" class="info-text {{ 'hidden' if not user_profile or not user_profile.height or not user_profile.weight else '' }}">
                Your BMI: <span id="bmi-value">{{ bmi if bmi else '' }}</span>
                <span id="bmi-category" class="help-text {{ bmi_category if bmi_category else '' }}">{{ bmi_message if bmi_message else '' }}</span>
            </div>
        </div>
        
        <div class="form-section slide-in fade-up" style="animation-delay: 0.3s;">
            <h2>Activity & Goals</h2>
            <div class="form-group">
                <label for="activity_level">Activity Level</label>
                <select id="activity_level" name="activity_level">
                    <option value="">Select</option>
                    <option value="sedentary" {{ 'selected' if user_profile and user_profile.activity_level == 'sedentary' else '' }}>Sedentary (little or no exercise)</option>
                    <option value="light" {{ 'selected' if user_profile and user_profile.activity_level == 'light' else '' }}>Lightly active (light exercise 1-3 days/week)</option>
                    <option value="moderate" {{ 'selected' if user_profile and user_profile.activity_level == 'moderate' else '' }}>Moderately active (moderate exercise 3-5 days/week)</option>
                    <option value="active" {{ 'selected' if user_profile and user_profile.activity_level == 'active' else '' }}>Active (hard exercise 6-7 days/week)</option>
                    <option value="very_active" {{ 'selected' if user_profile and user_profile.activity_level == 'very_active' else '' }}>Very active (very hard exercise & physical job)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="goal">Fitness Goal</label>
                <select id="goal" name="goal">
                    <option value="">Select</option>
                    <option value="lose_weight" {{ 'selected' if user_profile and user_profile.goal == 'lose_weight' else '' }}>Lose Weight</option>
                    <option value="maintain" {{ 'selected' if user_profile and user_profile.goal == 'maintain' else '' }}>Maintain Weight</option>
                    <option value="gain_muscle" {{ 'selected' if user_profile and user_profile.goal == 'gain_muscle' else '' }}>Gain Muscle</option>
                </select>
            </div>
        </div>
        
        <div class="form-section slide-in fade-up" style="animation-delay: 0.4s;">
            <h2>Dietary Preferences</h2>
            <div class="form-group">
                <label for="dietary_restrictions">Dietary Restrictions</label>
                <select id="dietary_restrictions" name="dietary_restrictions">
                    <option value="none" {{ 'selected' if user_profile and user_profile.dietary_restrictions == 'none' else '' }}>None</option>
                    <option value="vegetarian" {{ 'selected' if user_profile and user_profile.dietary_restrictions == 'vegetarian' else '' }}>Vegetarian</option>
                    <option value="vegan" {{ 'selected' if user_profile and user_profile.dietary_restrictions == 'vegan' else '' }}>Vegan</option>
                    <option value="pescatarian" {{ 'selected' if user_profile and user_profile.dietary_restrictions == 'pescatarian' else '' }}>Pescatarian</option>
                    <option value="gluten_free" {{ 'selected' if user_profile and user_profile.dietary_restrictions == 'gluten_free' else '' }}>Gluten-Free</option>
                    <option value="dairy_free" {{ 'selected' if user_profile and user_profile.dietary_restrictions == 'dairy_free' else '' }}>Dairy-Free</option>
                </select>
            </div>
        </div>
        
        <button type="submit" class="btn-save pulse">Save Profile</button>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const heightInput = document.getElementById('height');
    const weightInput = document.getElementById('weight');
    const bmiResult = document.getElementById('bmi-result');
    const bmiValue = document.getElementById('bmi-value');
    const bmiCategory = document.getElementById('bmi-category');
    
    function calculateBMI() {
        if (heightInput.value && weightInput.value) {
            const height = parseFloat(heightInput.value) / 100; // Convert cm to m
            const weight = parseFloat(weightInput.value);
            
            if (height > 0 && weight > 0) {
                const bmi = (weight / (height * height)).toFixed(1);
                bmiValue.textContent = bmi;
                
                let category = '';
                let message = '';
                
                // Remove any existing category classes
                bmiCategory.classList.remove('underweight', 'normal', 'overweight', 'obese');
                
                if (bmi < 18.5) {
                    category = 'underweight';
                    message = 'Underweight - Consider increasing calorie intake.';
                } else if (bmi >= 18.5 && bmi < 25) {
                    category = 'normal';
                    message = 'Normal weight - Maintain your healthy habits!';
                } else if (bmi >= 25 && bmi < 30) {
                    category = 'overweight';
                    message = 'Overweight - Consider a balanced diet and regular exercise.';
                } else {
                    category = 'obese';
                    message = 'Obese - Consult with a healthcare professional for guidance.';
                }
                
                bmiCategory.textContent = message;
                bmiCategory.classList.add(category);
                bmiResult.classList.remove('hidden');
                
                // Add animation class
                bmiResult.classList.add('slide-in');
            }
        }
    }
    
    // Calculate BMI when inputs change
    if (heightInput && weightInput) {
        heightInput.addEventListener('input', calculateBMI);
        weightInput.addEventListener('input', calculateBMI);
    }
});
</script>
{% endblock %} 